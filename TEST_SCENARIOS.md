# 纪念币预约辅助工具 - 测试场景文档

## 测试环境
- 浏览器：Chrome/Edge + Tampermonkey
- 测试脚本：index.js
- 测试数据：test_data.json

---

## 一、导入功能测试

### 1.1 正常导入
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| I001 | 导入格式正确的完整数据 | 成功导入，显示白色背景 |

### 1.2 数据过滤
| 场景ID | 描述 | 测试数据 | 预期结果 |
|--------|------|----------|----------|
| I002 | 三个主要字段都为空 | `{name: "", idCard: "", mobile: ""}` | 自动过滤，不导入 |
| I003 | 姓名为空，其他有值 | `{name: "", idCard: "xxx", mobile: "xxx"}` | 导入，显示橙色背景 |
| I004 | 身份证为空，其他有值 | `{name: "xxx", idCard: "", mobile: "xxx"}` | 导入，显示橙色背景 |
| I005 | 手机号为空，其他有值 | `{name: "xxx", idCard: "xxx", mobile: ""}` | 导入，显示橙色背景 |
| I006 | 只有姓名有值 | `{name: "xxx", idCard: "", mobile: ""}` | 导入，显示橙色背景 |

### 1.3 数据去重
| 场景ID | 描述 | 测试数据 | 预期结果 |
|--------|------|----------|----------|
| I007 | 完全重复（三个字段都相同） | 两条完全相同的记录 | 只保留第一条，提示去重 |
| I008 | 部分字段相同 | 姓名相同但身份证不同 | 两条都保留 |
| I009 | 字段不完整的重复 | 两条都有 name="张三"，但 mobile 都为空 | 两条都保留（不触发去重） |

### 1.4 数据类型校验
| 场景ID | 描述 | 测试数据 | 预期结果 |
|--------|------|----------|----------|
| I010 | 导入非数组数据 | `{"name": "test"}` | 提示"数据必须是数组格式" |
| I011 | 导入空数组 | `[]` | 提示"导入的数据为空" |
| I012 | 导入null | `null` | 提示"导入的文件格式不正确" |

### 1.5 格式错误数据
| 场景ID | 描述 | 测试数据 | 预期结果 |
|--------|------|----------|----------|
| I013 | 身份证格式错误 | idCard: "12345" | 导入，显示红色背景 |
| I014 | 身份证15位正确 | idCard: "110101900101123" | 导入，显示白色背景 |
| I015 | 身份证18位正确 | idCard: "110101199001011234" | 导入，显示白色背景 |
| I016 | 身份证18位带X | idCard: "11010119900101123X" | 导入，显示白色背景 |
| I017 | 手机号格式错误 | mobile: "12345" | 导入，显示红色背景 |
| I018 | 手机号10位 | mobile: "1380013800" | 导入，显示红色背景 |
| I019 | 手机号11位正确 | mobile: "13800138000" | 导入，显示白色背景 |

---

## 二、索引管理测试

### 2.1 初始索引
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| IDX001 | 导入10条数据 | 序号显示为 1-10 |
| IDX002 | 删除第5条 | 序号自动更新为 1-9 |
| IDX003 | 删除第1条 | 序号自动更新为 1-9 |
| IDX004 | 删除最后1条 | 序号自动更新为 1-9 |

### 2.2 新增索引
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| IDX005 | 在10条数据后新增 | 新数据显示序号 11 |
| IDX006 | 连续新增3条 | 序号正确递增 |

---

## 三、填充功能测试

### 3.1 填充验证
| 场景ID | 描述 | 测试条件 | 预期结果 |
|--------|------|----------|----------|
| F001 | 姓名为空 | name = "" | 无法填充（按钮不显示） |
| F002 | 身份证为空 | idCard = "" | 点击后提示"请完善身份证信息" |
| F003 | 手机号为空 | mobile = "" | 点击后提示"请完善手机号信息" |
| F004 | 三个必填都为空 | 三个都为空 | 点击后提示"请完善姓名、身份证、手机号信息" |
| F005 | 身份证格式错误 | idCard = "12345" | 点击后提示"身份证格式不正确" |
| F006 | 手机号格式错误 | mobile = "12345" | 点击后提示"手机号格式不正确" |
| F007 | 所有数据正确 | 三个必填都正确 | 成功填充表单 |

### 3.2 填充执行
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| F008 | 填充姓名字段 | 页面姓名输入框被填充 |
| F009 | 填充身份证字段 | 页面身份证输入框被填充 |
| F010 | 填充手机号字段 | 页面手机号输入框被填充 |
| F011 | 填充网点字段 | 页面网点选择框被选择 |
| F012 | 填充数量字段 | 页面数量输入框被填充 |

---

## 四、新增功能测试

### 4.1 新增验证
| 场景ID | 描述 | 测试条件 | 预期结果 |
|--------|------|----------|----------|
| A001 | 空白状态新增 | data.length = 0 | 成功新增一条空记录 |
| A002 | 最后一条姓名为空 | lastEntry.name = "" | 提示"请完善姓名信息" |
| A003 | 最后一条身份证为空 | lastEntry.idCard = "" | 提示"请完善身份证信息" |
| A004 | 最后一条手机号为空 | lastEntry.mobile = "" | 提示"请完善手机号信息" |
| A005 | 最后一条身份证格式错误 | lastEntry.idCard = "123" | 提示"身份证格式不正确" |
| A006 | 最后一条手机号格式错误 | lastEntry.mobile = "123" | 提示"手机号格式不正确" |
| A007 | 最后一条完全正确 | 三个必填都正确 | 成功新增一条空记录 |

### 4.2 新增后状态
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| A008 | 新增后的序号 | 序号正确递增 |
| A009 | 新增后的背景色 | 显示橙色背景（必填为空） |
| A010 | 新增后可编辑 | 可以正常编辑输入 |

---

## 五、删除功能测试

### 5.1 删除操作
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| D001 | 删除第1条 | 删除成功，序号自动更新 |
| D002 | 删除中间条 | 删除成功，序号自动更新 |
| D003 | 删除最后1条 | 删除成功，序号自动更新 |
| D004 | 连续删除多条 | 每次删除后序号正确更新 |

### 5.2 删除确认
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| D005 | 删除后提示 | 显示"表单已删除" |
| D006 | 删除后保存 | 数据自动保存 |

---

## 六、格式错误提示测试

### 6.1 HeaderRow 背景色
| 场景ID | 描述 | 测试条件 | 预期结果 |
|--------|------|----------|----------|
| H001 | 姓名为空 | name = "" | 橙色背景 |
| H002 | 身份证为空 | idCard = "" | 橙色背景 |
| H003 | 手机号为空 | mobile = "" | 橙色背景 |
| H004 | 身份证格式错误 | idCard = "123" | 红色背景 |
| H005 | 手机号格式错误 | mobile = "123" | 红色背景 |
| H006 | 全部正确 | 三个必填都正确 | 灰色背景 |

### 6.2 输入框背景色
| 场景ID | 字段 | 测试条件 | 预期结果 |
|--------|------|----------|----------|
| IN001 | 姓名 | 为空 | 红色背景 |
| IN002 | 姓名 | 有值 | 白色背景 |
| IN003 | 身份证 | 为空 | 红色背景 |
| IN004 | 身份证 | 格式错误 | 红色背景 |
| IN005 | 身份证 | 格式正确 | 白色背景 |
| IN006 | 手机号 | 为空 | 红色背景 |
| IN007 | 手机号 | 格式错误 | 红色背景 |
| IN008 | 手机号 | 格式正确 | 白色背景 |
| IN009 | 网点 | 任意状态 | 白色背景 |
| IN010 | 数量 | 任意状态 | 白色背景 |

### 6.3 实时更新
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| UP001 | 输入时实时更新 | 背景色随输入实时变化 |
| UP002 | 失焦后更新 | 背景色在失焦后更新 |
| UP003 | 删除内容后更新 | 清空后立即显示红色背景 |

---

## 七、数据保存/加载测试

### 7.1 数据保存
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| S001 | 输入后保存 | 失焦后自动保存 |
| S002 | 删除后保存 | 删除后自动保存 |
| S003 | 新增后保存 | 新增后自动保存 |
| S004 | 导入后保存 | 导入后自动保存 |

### 7.2 数据加载
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| L001 | 刷新页面 | 数据正确加载 |
| L002 | 重新打开脚本 | 数据正确加载 |
| L003 | 加载后索引 | 索引正确显示 |

### 7.3 数据迁移
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| M001 | 加载旧数据（无index字段） | 自动添加 index 字段 |
| M002 | 加载重复数据 | 自动去重 |
| M003 | 加载格式错误数据 | 自动清洗，保留数据 |

---

## 八、边界条件测试

### 8.1 特殊字符
| 场景ID | 描述 | 测试数据 | 预期结果 |
|--------|------|----------|----------|
| B001 | 姓名包含特殊字符 | name: "张·三" | 正常处理 |
| B002 | 姓名包含英文 | name: "Zhang San" | 正常处理 |
| B003 | 姓名包含数字 | name: "张三123" | 正常处理 |
| B004 | 身份证小写x | idCard: "110101199001011234x" | 正常处理 |

### 8.2 数据量测试
| 场景ID | 描述 | 测试数据 | 预期结果 |
|--------|------|----------|----------|
| V001 | 单条数据 | 1条记录 | 正常显示 |
| V002 | 中等数据量 | 20条记录 | 正常显示，滚动正常 |
| V003 | 大数据量 | 100条记录 | 正常显示，滚动正常 |

### 8.3 导出功能
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| E001 | 导出数据 | 下载 JSON 文件 |
| E002 | 导出内容检查 | 只包含5个字段，不含index |
| E003 | 导出后导入 | 导出的数据可以正常导入 |

---

## 九、UI交互测试

### 9.1 折叠/展开
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| UI001 | 默认状态 | 卡片默认折叠 |
| UI002 | 点击展开按钮 | 展开显示详细内容 |
| UI003 | 点击折叠按钮 | 折叠隐藏详细内容 |
| UI004 | 展开/折叠状态保持 | 操作卡片不影响其他卡片 |

### 9.2 拖拽功能
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| UI005 | 拖拽容器 | 容器跟随鼠标移动 |
| UI006 | 拖拽到边界 | 自动限制在视口内 |
| UI007 | 拖拽后位置保存 | 刷新后位置保持 |

### 9.3 收起/展开按钮
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| UI008 | 点击收起按钮 | 显示展开按钮 |
| UI009 | 点击展开按钮 | 显示主容器 |
| UI010 | 收起后可拖拽 | 展开按钮可拖拽移动 |

---

## 十、复制功能测试

### 10.1 字段复制
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| C001 | 复制姓名 | 姓名复制到剪贴板 |
| C002 | 复制身份证 | 身份证复制到剪贴板 |
| C003 | 复制手机号 | 手机号复制到剪贴板 |
| C004 | 复制网点 | 网点复制到剪贴板 |
| C005 | 复制数量 | 数量复制到剪贴板 |

### 10.2 复制提示
| 场景ID | 描述 | 预期结果 |
|--------|------|----------|
| C006 | 复制成功提示 | 显示"xxx已复制" |
| C007 | 复制空字段 | 不显示提示 |

---

## 测试统计

| 测试类别 | 场景数量 |
|----------|----------|
| 导入功能 | 19 |
| 索引管理 | 6 |
| 填充功能 | 12 |
| 新增功能 | 10 |
| 删除功能 | 6 |
| 格式错误提示 | 16 |
| 数据保存/加载 | 9 |
| 边界条件 | 9 |
| UI交互 | 10 |
| 复制功能 | 7 |
| **总计** | **104** |

---

## 测试执行记录

| 日期 | 测试人员 | 测试场景 | 结果 | 备注 |
|------|----------|----------|------|------|
| YYYY-MM-DD | - | - | - | - |
